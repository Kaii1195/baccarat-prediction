<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Baccarat Prediction System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <button class="help-icon" onclick="openGuideModal()" aria-label="Hướng dẫn sử dụng">
                <span>?</span>
                <span class="help-tooltip">Hướng dẫn sử dụng</span>
            </button>
            <h1>
                <span class="header-logo-icon">👑</span>
                <span>Baccarat Prediction</span>
            </h1>
            <p>Hệ Thống Dự Đoán Đa Phương Pháp</p>
        </header>

        <div class="three-column-layout">
            <!-- LEFT PANEL -->
            <div class="left-panel">
                <section class="panel-section">
                    <h2> Nhập Kết Quả</h2>
                    <div class="shoe-info-display">
                        <strong id="shoe-info">Shoe #1</strong>
                        <span id="hand-count">0/80 phiên</span>
                    </div>
                    <div class="input-buttons">
                        <button class="result-btn banker" onclick="playSound('banker'); addResult('B')">🔴 Banker</button>
                        <button class="result-btn player" onclick="playSound('player'); addResult('P')">🔵 Player</button>
                        <button class="result-btn tie" onclick="playSound('tie'); addResult('T')">🟢 Tie</button>
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="undoLast()" title="Hoàn tác kết quả cuối">
                            <span class="btn-icon">↩️</span>
                            <span class="btn-label">Hoàn tác</span>
                        </button>
                        <button class="action-btn" onclick="resetShoe()" title="Bắt đầu shoe mới">
                            <span class="btn-icon">🎴</span>
                            <span class="btn-label">Shoe mới</span>
                        </button>
                        <button class="action-btn" onclick="clearAll()" title="Xóa tất cả dữ liệu">
                            <span class="btn-icon">🗑️</span>
                            <span class="btn-label">Xóa hết</span>
                        </button>
                    </div>
                </section>

                <section class="panel-section">
                    <h2> Hiệu Suất Dự Đoán</h2>
                    <div class="prediction-stats">
                        <div class="stat-item stat-winrate">
                            <span class="stat-icon">✅</span>
                            <div class="stat-data">
                                <div class="stat-label">Tỷ Lệ Thắng</div>
                                <div class="stat-value" id="prediction-winrate">0%</div>
                            </div>
                        </div>
                        <div class="stat-item stat-streak">
                            <span class="stat-icon" id="streak-icon">🔥</span>
                            <div class="stat-data">
                                <div class="stat-label">Chuỗi Hiện Tại</div>
                                <div class="stat-value" id="prediction-streak">-</div>
                            </div>
                        </div>
                        <div class="stat-item stat-loss">
                            <span class="stat-icon">⚠️</span>
                            <div class="stat-data">
                                <div class="stat-label">Chuỗi Thua Dài Nhất</div>
                                <div class="stat-value" id="max-loss-streak">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="prediction-summary-grid">
                        <div class="summary-item summary-correct">
                            <span class="summary-icon">✓</span>
                            <div class="summary-data">
                                <div class="summary-label">Đúng</div>
                                <div class="summary-value" id="prediction-correct">0</div>
                            </div>
                        </div>
                        <div class="summary-item summary-wrong">
                            <span class="summary-icon">✗</span>
                            <div class="summary-data">
                                <div class="summary-label">Sai</div>
                                <div class="summary-value" id="prediction-wrong">0</div>
                            </div>
                        </div>
                        <div class="summary-item summary-total">
                            <span class="summary-icon">Σ</span>
                            <div class="summary-data">
                                <div class="summary-label">Tổng</div>
                                <div class="summary-value" id="prediction-total">0</div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- CENTER PANEL -->
            <div class="center-panel">
                <section class="panel-section prediction-hero-section">
                    <h2>⭐ THẦN BÀI DỰ ĐOÁN</h2>
                    <div class="prediction-hero-card">
                        <div class="prediction-result-hero" id="pred-composite">
                            <span class="pred-label">Chờ dữ liệu...</span>
                        </div>
                        <div class="confidence-display" id="confidence-text"></div>
                    </div>
                </section>

                <section class="panel-section history-section">
                    <h2> Lịch Sử</h2>
                    <div class="history-container">
                        <div class="history-display" id="history-display">
                            <p class="empty-message">Chưa có dữ liệu. Nhấn nút phía trên để thêm kết quả.</p>
                        </div>
                    </div>
                    <div class="history-footer">
                        <span id="current-streak">N/A</span>
                        <span class="divider">|</span>
                        <span id="longest-streak-inline">Max: N/A</span>
                    </div>
                </section>
            </div>

            <!-- RIGHT PANEL -->
            <div class="right-panel">
                <section class="panel-section">
                    <h2> Thống Kê</h2>
                    <div class="stats-grid">
                        <div class="stat-box banker">
                            <h3>Banker</h3>
                            <div class="stat-number" id="banker-count">0</div>
                            <div class="stat-percentage" id="banker-percent">0%</div>
                        </div>
                        <div class="stat-box player">
                            <h3>Player</h3>
                            <div class="stat-number" id="player-count">0</div>
                            <div class="stat-percentage" id="player-percent">0%</div>
                        </div>
                        <div class="stat-box tie">
                            <h3>Tie</h3>
                            <div class="stat-number" id="tie-count">0</div>
                            <div class="stat-percentage" id="tie-percent">0%</div>
                        </div>
                        <div class="stat-box total">
                            <h3>Total</h3>
                            <div class="stat-number" id="total-count">0</div>
                            <div class="stat-percentage" id="total-percent">0%</div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <footer class="main-footer">
            <p>
                <span class="footer-icon">🎰</span>
                <span class="footer-brand">Baccarat Prediction System</span>
                <span class="footer-separator">·</span>
                <span class="footer-dev">Developed by DADO</span>
                <span class="footer-separator">·</span>
                <span class="footer-year">© 2025 - All Rights Reserved</span>
            </p>
        </footer>
    </div>

    <!-- GUIDE MODAL -->
    <div id="guideModal" class="guide-modal" onclick="closeGuideModal(event)">
        <div class="guide-modal-content" onclick="event.stopPropagation()">
            <div class="guide-modal-header">
                <h2>🎯 HƯỚNG DẪN SỬ DỤNG</h2>
                <button class="guide-close-btn" onclick="closeGuideModal()">&times;</button>
            </div>
            
            <div class="guide-modal-body">
                <!-- Tabs -->
                <div class="guide-tabs">
                    <button class="guide-tab active" onclick="switchGuideTab('start')">Bắt Đầu</button>
                    <button class="guide-tab" onclick="switchGuideTab('features')">Chức Năng</button>
                </div>
                
                <!-- Tab Content: Bắt Đầu -->
                <div id="guide-start" class="guide-tab-content active">
                    <h3>🚀 Bắt Đầu Nhanh</h3>
                    
                    <div class="guide-step">
                        <div class="guide-step-number">1️⃣</div>
                        <div class="guide-step-content">
                            <h4>Nhập Kết Quả</h4>
                            <p>Nhấn nút <strong>Banker</strong>, <strong>Player</strong>, hoặc <strong>Tie</strong> sau mỗi ván chơi</p>
                            <p class="guide-note">💡 Cần tối thiểu <strong>20 ván</strong> để hệ thống bắt đầu dự đoán</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <div class="guide-step-number">2️⃣</div>
                        <div class="guide-step-content">
                            <h4>Xem Dự Đoán</h4>
                            <p>Sau 20 ván, hệ thống sẽ hiển thị dự đoán cho ván tiếp theo với tỷ lệ thắng</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <div class="guide-step-number">3️⃣</div>
                        <div class="guide-step-content">
                            <h4>Hiệu Suất Dự Đoán</h4>
                            <p>Theo dõi độ chính xác qua các chỉ số:</p>
                            <ul>
                                <li><strong>Tỷ lệ thắng</strong>: % dự đoán đúng</li>
                                <li><strong>Chuỗi hiện tại</strong>: 🔥 Thắng liên tiếp / ❄️ Thua liên tiếp</li>
                                <li><strong>Chuỗi thua dài nhất</strong>: Theo dõi rủi ro</li>
                                <li><strong>Đúng/Sai/Tổng</strong>: Tổng hợp kết quả</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="guide-disclaimer">
                        <h4>⚠️ Lưu Ý Quan Trọng</h4>
                        <ul>
                            <li>Đây là công cụ <strong>hỗ trợ phân tích</strong>, không đảm bảo 100% chính xác</li>
                            <li>Baccarat là trò chơi may rủi, hãy quản lý vốn cẩn thận</li>
                            <li>Không chơi quá khả năng tài chính của bạn</li>
                            <li>Chỉ sử dụng cho mục đích giải trí và học tập</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Tab Content: Chức Năng -->
                <div id="guide-features" class="guide-tab-content">
                    <h3>🔧 Chức Năng Khác</h3>
                    
                    <div class="guide-feature">
                        <h4>↩️ Hoàn Tác (Undo)</h4>
                        <p>Nhấn nút <strong>X</strong> để xóa ván vừa nhập</p>
                        <p class="guide-note">Stats sẽ tự động điều chỉnh</p>
                    </div>
                    
                    <div class="guide-feature">
                        <h4>🎴 Shoe Mới</h4>
                        <p>Nhấn <strong>Shoe Mới</strong> khi bắt đầu bộ bài mới</p>
                        <p class="guide-note">Lịch sử cũ được lưu vào Shoe History</p>
                    </div>
                    
                    <div class="guide-feature">
                        <h4>🗑️ Xóa Hết</h4>
                        <p>Nhấn <strong>Xóa Hết</strong> để reset toàn bộ dữ liệu</p>
                        <p class="guide-warning">⚠️ Lưu ý: Không thể hoàn tác!</p>
                    </div>
                    
                    <h3 style="margin-top: 30px;">💡 Mẹo Sử Dụng</h3>
                    <ul class="guide-tips">
                        <li>✅ Chờ tỷ lệ thắng <strong>≥70%</strong> để quyết định quan trọng</li>
                        <li>✅ Theo dõi <strong>Chuỗi thua dài nhất</strong> để quản lý rủi ro</li>
                        <li>✅ Sử dụng <strong>Shoe Mới</strong> thường xuyên để dữ liệu chính xác</li>
                        <li>✅ Kiểm tra <strong>Pattern</strong> và <strong>Streak</strong> trong Thống Kê</li>
                    </ul>
                </div>
                
            </div>
            
            <div class="guide-modal-footer">
                <button class="guide-btn-primary" onclick="closeGuideModal()">Đã Hiểu</button>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileImport(event)">
    <script src="app.js"></script>
</body>
</html>
